# 팀원 브랜치 테스트 시나리오

팀원과 Git 협업이 정상 동작하는지 확인하기 위한 단계별 시나리오.
`docs/99_Git협업.md`의 브랜치 전략과 흐름을 그대로 따른다.

---

## 전제 조건

- 저장소: https://github.com/deflow-nhnad/whynali.git
- 브랜치: `main`(배포용), `dev`(개발 통합)
- 협업자: 팀장(A), 팀원(B) 각 1명

---

## Phase 0: 저장소 연동 (최초 1회)

### A: 이미 코드가 있는 폴더(whynali-02)를 GitHub에 올리는 경우

```bash
cd whynali-02
# 프로젝트 폴더로 이동
git init
# 현재 폴더를 Git 저장소로 초기화 (.git 생성)
git remote add origin https://github.com/deflow-nhnad/whynali.git
# 원격 저장소 주소를 origin 이름으로 등록
```

원격에 이미 `main`이 있으면:

```bash
git fetch origin
# 원격(origin)의 최신 브랜치/커밋 정보만 가져오기 (로컬 브랜치 안 만듦)
git checkout -b main origin/main
# 원격 main을 따라가는 로컬 main 브랜치 생성 후 전환
git checkout -b dev origin/dev   # dev가 있으면
# 원격 dev를 따라가는 로컬 dev 브랜치 생성 후 전환
```

원격이 비어 있으면:

```bash
git checkout -b main
# main 브랜치 생성 후 해당 브랜치로 전환
# .gitignore 확인 후
git add .
# 현재 디렉터리 변경 사항 전부 스테이징(커밋 대상으로 추가)
git commit -m "초기 커밋: 문서 및 설정"
# 스테이징된 내용을 로컬 저장소에 커밋
git push -u origin main
# 로컬 main을 원격 main에 올리고, 이후 push 시 origin main을 기본으로 설정
git checkout -b dev
# dev 브랜치 생성 후 전환 (현재 main 기준)
git push -u origin dev
# 로컬 dev를 원격에 올려 원격 dev 브랜치 생성
```

### B: 새로 클론하는 경우

```bash
git clone https://github.com/deflow-nhnad/whynali.git
# 원격 저장소 전체를 whynali 폴더로 복제
cd whynali
# 복제된 프로젝트 폴더로 이동
git checkout dev
# dev 브랜치로 전환 (일상 작업은 dev 기준)
```

---

## Phase 1: 브랜치 생성 및 푸시 (A 담당)

1. `dev` 기준 최신화 후 기능 브랜치 생성

```bash
git checkout dev
# dev 브랜치로 전환
git pull origin dev
# 원격 dev의 최신 커밋을 받아와 로컬 dev에 반영
git checkout -b feature/팀장-테스트문서
# dev 기준으로 기능 브랜치 생성 후 전환
```

2. 테스트용 변경 (예: 문서 한 줄 추가) 후 커밋

```bash
# docs/99_브랜치테스트_시나리오.md 등 수정
git add .
# 변경된 파일 전부 스테이징
git commit -m "브랜치 테스트: 시나리오 문서 추가"
# 스테이징된 내용을 커밋
git push -u origin feature/팀장-테스트문서
# 해당 브랜치를 원격에 올리고, 이후 push 시 이 브랜치가 기본으로 설정됨
```

3. GitHub에서 PR 생성
   - Base: `dev`, Compare: `feature/팀장-테스트문서`
   - 제목/설명 입력 후 Create pull request

---

## Phase 2: PR 확인 및 머지 (B 담당)

1. GitHub 저장소 → Pull requests에서 해당 PR 열기
2. Files changed 탭에서 변경 내용 확인
3. Merge pull request → Confirm merge
4. (선택) Merge된 브랜치 삭제

---

## Phase 3: dev 최신화 및 팀원 브랜치 작업 (B 담당)

1. 로컬에서 `dev`로 전환 후 최신 코드 받기

```bash
git checkout dev
# dev 브랜치로 전환
git pull origin dev
# 원격 dev 최신 코드 받기 (팀장이 머지한 내용 반영)
```

2. 팀원용 기능 브랜치 생성 및 작업

```bash
git checkout -b feature/팀원-테스트문서
# dev 기준 팀원용 기능 브랜치 생성 후 전환
# 예: docs 아래 새 파일 추가 또는 기존 문서 수정
git add .
# 변경 사항 스테이징
git commit -m "브랜치 테스트: 팀원 수정 반영"
# 커밋
git push -u origin feature/팀원-테스트문서
# 원격에 브랜치 올리고 upstream 설정
```

3. GitHub에서 PR 생성 (Base: `dev`, Compare: `feature/팀원-테스트문서`)

---

## Phase 4: 두 번째 PR 머지 및 양쪽 최신화 (A 담당 후 공통)

1. A: GitHub에서 B의 PR 리뷰 후 Merge
2. A와 B 모두 로컬에서:

```bash
git checkout dev
# dev 브랜치로 전환
git pull origin dev
# 원격 dev 최신화 (머지된 PR 내용 반영)
```

3. `git log --oneline -5`로 상대방 커밋이 들어왔는지 확인
   - 최근 커밋 5개를 한 줄씩 보여줌

---

## Phase 5: 충돌 없음 확인 (선택)

- A는 `feature/팀장-xxx`, B는 `feature/팀원-xxx`에서 **서로 다른 파일**만 수정했는지 확인
- 같은 파일 같은 줄을 수정했다면 `git pull origin dev` 또는 머지 시 충돌 발생. `99_Git협업.md` 9장 참고

---

## 체크리스트

| 단계 | 담당 | 확인 항목 |
|------|------|-----------|
| 0 | A | origin 연동, main/dev 푸시 또는 fetch 후 브랜치 일치 |
| 1 | A | feature 브랜치 푸시, PR 생성(dev로) |
| 2 | B | PR 내용 확인, dev에 머지 |
| 3 | B | dev pull 후 새 feature 브랜치에서 작업, PR 생성 |
| 4 | A, B | B의 PR 머지 후 둘 다 dev pull로 최신화 |
| 5 | A, B | 서로 다른 파일 수정 시 충돌 없음 확인 |

---

## 자주 쓰는 명령어 (테스트 시 참고)

```bash
git status
# 변경/스테이징된 파일, 현재 브랜치 등 상태 확인
git branch -a
# 로컬·원격 포함 모든 브랜치 목록 확인
git checkout dev && git pull origin dev
# dev로 전환한 뒤 원격 dev 최신 코드 받기
git checkout -b feature/역할-기능명
# dev 기준 기능 브랜치 생성 후 전환
git add . && git commit -m "메시지" && git push -u origin feature/역할-기능명
# 전부 스테이징 → 커밋 → 원격 해당 브랜치로 푸시
```

---

## 트러블슈팅

- **push rejected**: 원격에 새 커밋이 있음. `git pull origin dev` (또는 해당 브랜치) 후 `git push`
- **원격에 dev 없음**: A가 `main` 푸시 후 `git checkout -b dev && git push -u origin dev`로 생성
- **충돌**: `99_Git협업.md` 9장 충돌 해결 절차 따르기

이 시나리오를 한 번 완료하면 일상 작업은 `99_Git협업.md` 6~8장 흐름으로 진행하면 된다.
